# Сервис автоматизации сбора информации об автоотчете и создании/обновлении/отключении задач в Task Scheduler.

Сервис собирает информацию об автоотчете и записывает её в БД.
Если при отработке сервиса возникали ошибки с типом `error` или `critical`, то будет отправлено письмо на `fake@fake.ru` с двумя вложенными файлами логов запуска синхронизации с репозиторием и отработки самого сервиса.  
Не требует ручной синхронизации, т.к. он происходит автоматически при запуске из `Scheduler` или через файл `*.cmd`.

## Принцип запуска и работы сервиса

Есть автоматический запуск через Task Scheduler, который будет ежедневно поддерживать актуальность в БД собирая всю необходимую информацию.  
Есть возможность запустить вручную, как через тот же Scheduler, так и из папки или командую строку.  

### Запуск с помощью `cmd` из папки

В таком варианте будет запускаться обновление всех автоотчетов. Т.к. там указан аргумент по умолчанию.
1. Заходим на сервер.
2. Заходим в папку, где расположен данный сервис.
3. Запускаем из-под администратора файл - `*.cmd`


### Запуск из комадной строки

1. Заходим на сервер.
2. Открываем командую строку из-под администратора.
3. Переходим в командой строке в папку, где расположен данный сервис:
```bash
cd путь_к_папке
```
4. Набираем команду с одним из принимаемых аргументов - `find`, `daily_update`. С аргументом `find` можно указать сразу номер запроса для обновления информации только о конкретном(ых) автоотчете(ах):
```bash
python.exe main.py --tasks find
```
ИЛИ
```bash
python.exe main.py --tasks find,RA0000000000001
```
ИЛИ
```bash
python.exe main.py --tasks daily_update
```

## Собираемые данные

- Информация о заказчике, его структурном подразделении и дате выполнения заявки.
- Информация о получателе, его структурном подразделении и дате выполнения заявки.
- Информация о созданной задаче в Task Scheduler (путь к исполняемом файлу, периоде рассылки и пр.).
- Информация о теме и получателях письма.
- Информация о наименовании и типе БД.

## Внесение изменений в текущий проект

1. Клонируем проект к себе командой:
```bash
git clone git@github.com:wtfucka/automation_reports.git
```
2. Если проект уже склонирован, то сперва сверяем актульность вашей локальной папки с репозиторием командой:
```bash
git status
```
3. Если проект не актуален, то выполняем:
```bash
git pull
```
4. Вносим изменения и закидываем их в репозиторий командами:
```bash
git add .
git commit -m "Здесь краткий комментарий причин внесенных изменений"
git push
```

*_created by:* [me](https://github.com/wtfucka "wtfucka")